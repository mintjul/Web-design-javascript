<!DOCTYPE html>
<HTML lang="fi">

<head>
	<meta charset="utf-8">
	<title>Työpaja 7</title>
	<link rel="stylesheet" href="css/styles.css">
	 <style>
    table {
      border-collapse: collapse;
      width: 100%;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: left;
    }
    th {
      background-color: #f2f2f2;
    }
    img {
      max-width: 80px;
    }
  </style>
</head>

<body class="ws8">
	<h1>Työpaja 7: JSON/XML:n parsiminen AJAXilla</h1>
	<hr />
	<p>Tässä harjoituksessa harjoittelemme JSONin käyttöä JavaScript-sovelluksissa. Käytä luentomateriaalia rinnalla
		viitteenä näiden tehtävien aikana.</p>

	<hr />
	<h2>Harjoitus 1: JSONin perusteet</h2>
	<p>JSON tarkoittaa JavaScript Object Notationia, ja se tarkoittaa, että esittelemme datan muodossa, jonka JavaScript
		ymmärtää sellaisenaan. Muunnoksia ei tarvita sen käyttämiseen.</p>
	<p>
		<button onclick= "naytanimet()" > Näytä vain etu- ja sukunimi</button>
		<button onclick= "naytakaikki()" > Näytä kaikki tiedot</button>
	</p>
	<p>Kokeillaan seuraavaa. Voit luoda uuden JSON-datasetin JavaScript-koodissasi alla olevan mallin mukaisesti. Luo
		sitten funktiot, jotka suoritetaan, kun painikkeita klikataan.</p>

	<pre>
			var text = '{ "employees" : [' +
			'{ "firstName":"John" , "lastName":"Doe" },' +
			'{ "firstName":"Anna" , "lastName":"Smith" },' +
			'{ "firstName":"Peter" , "lastName":"Jones" } ]}';
		</pre>
	<ul>
		<li>Ensimmäinen painike näyttää etu- ja sukunimen jokaisesta kohteesta alla olevassa divissä.</li>
		<li>Toinen painike näyttää kaikki tiedot kaikista kohteista alla olevassa divissä. Halutessasi voit käyttää
			for-silmukoita tässä.</li>
	</ul>

	<div id="jsondata">JSON-data näkyy täällä.</div>

	<hr />
	<h2>Harjoitus 2: JSONin parsiminen verkosta</h2>
	<p>Alla näet kaksi painiketta. Muokkaa lähdekoodia ja lisää näihin painikkeisiin onClick-tapahtumat. Lisää
		toiminnallisuudet alla kuvatulla tavalla.</p>
	<p>
		<button>Lataa raaka data</button>
		<button>Lataa ja parsi data</button>
	</p>

	<ul>
		<li>Ensimmäisen painikkeen tulee suorittaa JavaScript-funktio, joka lataa annetun <a
				href="http://www.omdbapi.com/?s=star+wars&apikey=cbbc6750">JSON-tiedoston verkosta</a> ja näyttää sen
			raakatiedot alla olevassa divissä (id=rawdata). Käytä kehittäjätyökaluja (F12) seurataksesi AJAX-kutsua ja
			tutki otsikoita, suoritus­aikoja jne.</li>
		<li>Toisen painikkeen tulee suorittaa funktio, joka lataa saman datan, mutta parsii sen ja näyttää tiedot
			taulukossa.</li>
		<li>Kun olet saanut datan näkyviin, kokeile ladata myös kuvat sivulle.</li>
	</ul>
	<div id="rawdata">Raaka data näkyy täällä.</div>

	<hr />
	<h2>Harjoitus 3: Käytännön haaste: OpenWeatherMap API</h2>

	<p>OpenWeatherMap on tunnettu säädatan tarjoaja verkossa. Se tarjoaa API:n, jonka avulla kehittäjät voivat hakea
		säätietoja. <a href="https://openweathermap.org/api">Dokumentaatio löytyy täältä</a>.</p>
	<p>Tehtäväsi on kirjoittaa Sää-sovellus, joka näyttää säätiedot käyttäjän toiveiden mukaan. <b>Huomaa, että sinun
			täytyy rekisteröityä (ilmaista) saadaksesi API-avaimen, joka mahdollistaa palvelun käytön.</b></p>

	<p>Esimerkkikutsu REST API:iin voisi näyttää tältä: <a
			href="http://api.openweathermap.org/data/2.5/weather?q=Helsinki&units=metric&mode=JSON&APPID=ff64c247a136f706923d1ee0d55d71e2">http://api.openweathermap.org/data/2.5/weather?q=Helsinki&units=metric&mode=JSON&APPID=ff64c247a136f706923d1ee0d55d71e2</a>.
		Klikkaa nähdäksesi vastauksen.</p>
	<ul>
		<li>Kehitä ensin sovellus, joka näyttää raakatiedot säästä (lämpötila, pilvisyys, ilmankosteus) tietyssä
			kaupungissa, kun painiketta klikataan. <button>Hae data</button></li>
		<li>Kun tämä toimii, parsi data ja tulosta se diviin.</li>
		<li>Tämän jälkeen lisää onchange-tapahtuma pudotusvalikkoon, jotta käyttäjä voi valita, minkä kaupungin tiedot
			näytetään listalta.</li>
		<li>Lopuksi lisää toiminnallisuus syötekenttään, johon käyttäjä voi kirjoittaa hakukyselyn, joka lähetetään
			OpenWeatherMap API:lle ja jonka tulokset näytetään sovelluksessa.</li>
	</ul>
	<p>Valitse kaupunki listalta:</p>
	<select name="mySelect" id="city" onchange="">
		<option value="Helsinki">Helsinki</option>
		<option value="Stockholm">Tukholma</option>
		<option value="Rome">Rooma</option>
		<option value="New York">New York</option>
	</select>
	<p>Tai kirjoita hakusana: <input id="citysearch" /><button id="search">Hae</button></p>
	<div id="weatherdata">Säätiedot näkyvät täällä.</div>

 <script>
	//tehtävä 1
    var text = '{ "employees" : [' +
      '{ "firstName":"John" , "lastName":"Doe" },' +
      '{ "firstName":"Anna" , "lastName":"Smith" },' +
      '{ "firstName":"Peter" , "lastName":"Jones" } ]}';

    var obj = JSON.parse(text);

    function naytanimet() {
      var tulos = "";
      for (var i = 0; i < obj.employees.length; i++) {
        tulos += obj.employees[i].firstName + " " + obj.employees[i].lastName + "<br>";
      }
      document.getElementById("jsondata").innerHTML = tulos;
    }

    function naytakaikki() {
      var tulos = "";
      for (var i = 0; i < obj.employees.length; i++) {
        tulos += "Etunimi: " + obj.employees[i].firstName +
                 ", Sukunimi: " + obj.employees[i].lastName + "<br>";
      }
      document.getElementById("jsondata").innerHTML = tulos;
    }

	//tehtävä 2

  </script>
</body>

</html>